import{u as E}from"./vue-clipboard3-81308b3a.js";import{_ as P}from"./index-b9f773a6.js";import{k as q,r as c,ag as h,o as s,c as r,a as o,Q as T,I as _,M as b,H as f,P as g,L as p,O as k}from"./@vue-330d97db.js";import"./clipboard-11dc70c3.js";import"./APlayer-9761ea46.js";import"./element-plus-d7f7ad33.js";import"./lodash-es-32f1e46b.js";import"./@vueuse-df397a67.js";import"./@element-plus-4e918346.js";import"./@popperjs-c75af06c.js";import"./@ctrl-f8748455.js";import"./dayjs-d2501332.js";import"./async-validator-10c6301d.js";import"./memoize-one-297ddbcb.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-5ec34e26.js";import"./vue-router-058388f3.js";import"./vue-cookies-fe30a31f.js";import"./@highlightjs-189340a0.js";import"./highlight.js-f4cd52b3.js";import"./axios-439bb627.js";import"./docx-preview-01ead95e.js";import"./jszip-34d9bb61.js";import"./xlsx-04f2268f.js";import"./vue-pdf-embed-1732b75d.js";import"./vue-2734522e.js";import"./dplayer-c9b96a6f.js";const w={class:"top"},z={class:"file-list"},H=["onMouseenter","onMouseleave"],j=["title"],F={class:"op"},Q=["onClick"],U=["onClick"],A={__name:"Share",setup(G){const{toClipboard:C}=E(),{proxy:l}=q(),v={loadDataList:"/share/loadShareList",cancelShare:"/share/cancelShare"},x=c(document.location.origin+"/share/"),N=[{label:"文件名",prop:"fileName",scopedSlots:"fileName"},{label:"分享时间",prop:"shareTime",width:200},{label:"失效时间",prop:"expireTime",scopedSlots:"expireTime",width:200},{label:"浏览次数",prop:"showCount",width:200}],n=c({}),I={extHeight:20,selectType:"checkbox"},y=async()=>{let t={pageNo:n.value.pageNo,pageSize:n.value.pageSize};t.category!=="all"&&delete t.filePid;let a=await l.Request({url:v.loadDataList,params:t});a&&(n.value=a.data)},O=t=>{n.value.list.forEach(a=>{a.showOp=!1}),t.showOp=!0},L=t=>{t.showOp=!1},M=async t=>{await C(`链接:${x.value}${t.shareId} 提取码: ${t.code}`),l.Message.success("复制成功")},i=c([]),$=t=>{i.value=[],t.forEach(a=>{i.value.push(a.shareId)})},u=c([]),D=()=>{i.value.length!=0&&(u.value=i.value,S())},B=t=>{u.value=[t.shareId],S()},S=async()=>{l.Confirm("你确定要取消分享吗？",async()=>{await l.Request({url:v.cancelShare,params:{shareIds:u.value.join(",")}})&&(l.Message.success("取消分享成功"),y())})};return(t,a)=>{const R=h("el-button"),m=h("icon"),V=h("Table");return s(),r("div",null,[o("div",w,[T(R,{type:"primary",disabled:i.value.length==0,onClick:D},{default:_(()=>a[0]||(a[0]=[o("span",{class:"iconfont icon-cancel"},null,-1),b("取消分享 ")])),_:1},8,["disabled"])]),o("div",z,[T(V,{columns:N,showPagination:!0,dataSource:n.value,fetch:y,options:I,onRowSelected:$},{fileName:_(({row:e})=>[o("div",{class:"file-item",onMouseenter:d=>O(e),onMouseleave:d=>L(e)},[(e.fileType==3||e.fileType==1)&&e.status!==0?(s(),f(m,{key:0,cover:e.fileCover},null,8,["cover"])):(s(),r(g,{key:1},[e.folderType==0?(s(),f(m,{key:0,fileType:e.fileType},null,8,["fileType"])):p("",!0),e.folderType==1?(s(),f(m,{key:1,fileType:0})):p("",!0)],64)),e.showRename?p("",!0):(s(),r("span",{key:2,class:"file-name",title:e.fileName},[o("span",null,k(e.fileName),1)],8,j)),o("span",F,[e.showOp&&e.fileId?(s(),r(g,{key:0},[o("span",{class:"iconfont icon-link",onClick:d=>M(e)},"复制链接",8,Q),o("span",{class:"iconfont icon-cancel",onClick:d=>B(e)},"取消分享",8,U)],64)):p("",!0)])],40,H)]),expireTime:_(({row:e})=>[b(k(e.validType==3?"永久":e.expireTime),1)]),_:1},8,["dataSource"])])])}}},be=P(A,[["__scopeId","data-v-e764b18f"]]);export{be as default};
