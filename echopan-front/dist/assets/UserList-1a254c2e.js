import{k as A,r as c,ag as s,o as h,c as k,a as d,Q as t,I as o,W as x,a6 as K,M as v,O as f,u as C,L as V,n as E}from"./@vue-330d97db.js";import{_ as H}from"./index-b9f773a6.js";import"./element-plus-d7f7ad33.js";import"./lodash-es-32f1e46b.js";import"./@vueuse-df397a67.js";import"./@element-plus-4e918346.js";import"./@popperjs-c75af06c.js";import"./@ctrl-f8748455.js";import"./dayjs-d2501332.js";import"./APlayer-9761ea46.js";import"./async-validator-10c6301d.js";import"./memoize-one-297ddbcb.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-5ec34e26.js";import"./vue-router-058388f3.js";import"./vue-cookies-fe30a31f.js";import"./@highlightjs-189340a0.js";import"./highlight.js-f4cd52b3.js";import"./axios-439bb627.js";import"./docx-preview-01ead95e.js";import"./jszip-34d9bb61.js";import"./xlsx-04f2268f.js";import"./vue-pdf-embed-1732b75d.js";import"./vue-2734522e.js";import"./dplayer-c9b96a6f.js";import"./vue-clipboard3-81308b3a.js";import"./clipboard-11dc70c3.js";const P={class:"top-panel"},Q={class:"file-list"},W={class:"avatar"},G={key:0,style:{color:"#529b2e"}},J={key:1,style:{color:"#f56c6c"}},X=["onClick"],Y=["onClick"],Z={__name:"UserList",setup(ee){const{proxy:n}=A(),b={loadDataList:"/admin/loadUserList",updateUserStatus:"/admin/updateUserStatus",updateUserSpace:"/admin/updateUserSpace"},D=[{label:"头像",prop:"avatar",width:80,scopedSlots:"avatar"},{label:"昵称",prop:"nickName"},{label:"邮箱",prop:"email"},{label:"空间使用",prop:"space",scopedSlots:"space"},{label:"加入时间",prop:"joinTime"},{label:"最后登录时间",prop:"lastLoginTime"},{label:"状态",prop:"status",scopedSlots:"status",width:80},{label:"操作",prop:"op",width:150,scopedSlots:"op"}],r=c({}),m=c({}),N={extHeight:20},u=async()=>{let l={pageNo:m.value.pageNo,pageSize:m.value.pageSize};Object.assign(l,r.value);let e=await n.Request({url:b.loadDataList,params:l});e&&(m.value=e.data)},L=l=>{n.Confirm(`你确定要【${l.status==0?"启动":"禁用"}】吗？`,async()=>{await n.Request({url:b.updateUserStatus,params:{userId:l.userId,status:l.status==0?1:0}})&&u()})},i=c({show:!1,title:"修改空间大小",buttons:[{type:"primary",text:"确定",click:()=>{q()}}]}),p=c({}),S=c(),z={changeSpace:[{required:!0,message:"请输入空间大小"}]},I=l=>{i.value.show=!0,E(()=>{S.value.resetFields(),p.value=Object.assign({},l)})},q=()=>{S.value.validate(async l=>{if(!l)return;let e={};Object.assign(e,p.value),await n.Request({url:b.updateUserSpace,params:e})&&(i.value.show=!1,n.Message.success("操作成功"),u())})};return(l,e)=>{const g=s("el-input"),_=s("el-form-item"),y=s("el-col"),w=s("el-option"),T=s("el-select"),F=s("el-button"),M=s("el-row"),U=s("el-form"),O=s("Avatar"),R=s("el-divider"),j=s("Table"),B=s("Dialog");return h(),k("div",null,[d("div",P,[t(U,{model:r.value,"label-width":"80px",onSubmit:e[2]||(e[2]=x(()=>{},["prevent"]))},{default:o(()=>[t(M,null,{default:o(()=>[t(y,{span:4},{default:o(()=>[t(_,{label:"用户昵称"},{default:o(()=>[t(g,{clearable:"",placeholder:"支持模糊查询",modelValue:r.value.nickNameFuzzy,"onUpdate:modelValue":e[0]||(e[0]=a=>r.value.nickNameFuzzy=a),modelModifiers:{trim:!0},onKeyup:K(u,["native"])},null,8,["modelValue"])]),_:1})]),_:1}),t(y,{span:4},{default:o(()=>[t(_,{label:"状态"},{default:o(()=>[t(T,{clearable:"",placeholder:"请选择状态",modelValue:r.value.status,"onUpdate:modelValue":e[1]||(e[1]=a=>r.value.status=a)},{default:o(()=>[t(w,{value:1,label:"启用"}),t(w,{value:0,label:"禁用"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(y,{span:4,style:{"padding-left":"10px"}},{default:o(()=>[t(F,{type:"primary",onClick:u},{default:o(()=>e[6]||(e[6]=[v(" 查询 ")])),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),d("div",Q,[t(j,{columns:D,showPagination:!0,dataSource:m.value,fetch:u,options:N},{avatar:o(({row:a})=>[d("div",W,[t(O,{userId:a.userId,avatar:a.qqAvatar},null,8,["userId","avatar"])])]),space:o(({row:a})=>[v(f(C(n).Utils.size2Str(a.useSpace))+"/"+f(C(n).Utils.size2Str(a.totalSpace)),1)]),status:o(({row:a})=>[a.status==1?(h(),k("span",G,"启用")):V("",!0),a.status==0?(h(),k("span",J,"禁用")):V("",!0)]),op:o(({row:a})=>[d("span",{class:"a-link",onClick:$=>I(a)},"分配空间",8,X),t(R,{direction:"vertical"}),d("span",{class:"a-link",onClick:$=>L(a)},f(a.status==0?"启用":"禁用"),9,Y)]),_:1},8,["dataSource"])]),t(B,{show:i.value.show,title:i.value.title,buttons:i.value.buttons,width:"400px",showCancel:!1,onClose:e[5]||(e[5]=a=>i.value.show=!1)},{default:o(()=>[t(U,{model:p.value,rules:z,ref_key:"formDataRef",ref:S,"label-width":"80px",onSubmit:e[4]||(e[4]=x(()=>{},["prevent"]))},{default:o(()=>[t(_,{label:"昵称"},{default:o(()=>[v(f(p.value.nickName),1)]),_:1}),t(_,{label:"空间大小",prop:"changeSpace"},{default:o(()=>[t(g,{clearable:"",placeholder:"请输入空间大小",modelValue:p.value.changeSpace,"onUpdate:modelValue":e[3]||(e[3]=a=>p.value.changeSpace=a)},{suffix:o(()=>e[7]||(e[7]=[v("MB")])),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show","title","buttons"])])}}},De=H(Z,[["__scopeId","data-v-109fa111"]]);export{De as default};
